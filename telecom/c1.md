# 通信原理

## 1 绪论

### 1.1 通信系统的组成

def: 消息, 信息, 信号, 数字/模拟, 通信(用电信号传输消息)

- 模拟通信系统的组成: 信源, 调制器, 信道, 解调器, 信宿
- 数字通信系统的组成: 信源, 发送机(信源编码, 加密器, 编码器, 调制器), 信道, 接收机(解调器, 信道译码器, 解密器, 信源译码器), 信宿

> 将没有调制解调的数字通信系统称为**基带传输通信系统**
>
> 进行模数转换称为模拟信道的数字化

### 1.2 数字通信的主要特点

抗干扰能力强, 差错可控, 易加密, 与现代技术结合; 频带利用率不高, 设备复杂

### 1.3 通信系统的分类

- 按传输介质:
- 按信号特征: 数字, 模拟
- 按工作频段: <>
- 按调制方式: 基带, 频带
- 移动通信, 固定通信
- 频分复用, 时分复用, 码分复用, 空分复用

### 1.4 通信方式的分类

- 单工, 全双工, 半双工
- 串序, 并序

### 1.5 通信系统的性能指标

- 有效性: (速度)
- 可靠性: (质量)
- 适应性, 经济性, 保密性等

> 对信息量和信息熵, 见信息论部分

- 有效性指标: **码元传输速率**: $R_B = \frac 1 {T_B} \quad (\mathrm{Baud})$ **信息传输速率**: $R_b = R_B\cdot \log_2 M \quad (\mathrm{bits}/s)$, **频带利用率**: $\eta = \frac {R_B} B \quad \eta_b = \frac {R_b} B$
- 可靠性指标: **码元差错率**: $P_e = \mathrm{false\; codes} /\mathrm{revceoved\;codes}$, **信息差错率**: $\mathrm{false\;bits}/\mathrm{received\;bits}$

## 2 随机信号和噪声分析

### 2.1 定义

def1: **随机过程** $X(t)$ 表示在时刻 $t_1$ 为随机变量 $X(t_1)$; 对n个时刻采样, 得到n个随机变量, 其分布构成随机过程的**n维分布函数**, 例如一维分布函数为: $F_1(x_1,t_1)=P[X(t_1)\le x_1]$, 密度函数为: $f_1 (x_1,t_1) = \frac {\partial F_1 (x,t_1)}{\partial x}|_x\quad (\mathrm{if\;exists})$, 二维概率分布函数为 $F_2(x_1,x_2,t_1,t_2) = p[X(t_1)\le x_1 \;\And\; X(t_2)\le x_2]$ 等.

def2: **随机过程的数学期望**: $a(t) = E[X(t)]$, **方差**: $\sigma^2 (t) = D[X(t)]$, **相关函数**: $R_{XY} (t_1,t_2) = E[X(t_1)Y(t_2)]\quad (X=Y\;\mathrm{称为自相关})$, **协方差** $B(t_1,t_2) = E[(X(t_1)-a(t_1))(X(t_2)-a(t_2))]$

def3: **噪声**的表示形式 $n(t) = n_c(t) \cos\omega t + n_s(t) \sin\omega t = \rho(t)\cos(\omega t +\varphi(t))$

### 2.2 平稳随机过程

def0: **狭义平稳**: n维分布的平稳(时移不变); **广义平稳**: 期望, 相关函数的平稳

def1: **平稳随机过程**

prop **平稳随机过程的性质**: 期望 $a(t) =a$ 与 $t$ 无关, 自相关函数 $R(t_1,t_2) = R(\tau)$ 只与 $\tau$ 有关

def2: 平稳随机过程的**各态历经性**: $a=\overline{a} ,\; R(\tau) = \overline R (\tau)\quad \mathrm{对每一次实现平均, 即对随机过程采样的统计}$

#### 2.2.2 平稳随机过程的自相关函数

prop **平稳随机过程自相关函数R的性质**: 
 - 是偶函数
 - $R(0)$ 是 $R(\tau)$ 的上界
 - 平均功率, 直流功率, 交流功率: $R(0)=E[X(t)^2],\;R(\inf)=E^2[X(t)]=a^2,\;\sigma^2 = R(0)-R(\inf)$

#### 2.2.3 平稳随机过程的功率谱密度

def: **平稳随机过程的功率谱P_X** (根据维纳-定理) 
$$\begin{cases}
    P_X(\omega) &=& \int^{\inf}_{-\inf} R(\tau) e^{-i\omega \tau}\mathrm{d} \tau\\
    R(\tau) &=& \frac 1 {2\pi} \int^{\inf}_{-\inf} P_X (\omega) e^{i\omega t}\mathrm{d} \omega
\end{cases}$$

prop $P_X(\omega)$ 的性质:
 - 是确定函数
 - 是偶函数
 - 非负性
 - 是任意实现的功率谱密度

### 2.3 高斯随机过程

def1: **高斯过程**: 
$$f(x_1,...,x_n,t_1,...,t_n) = \frac 1 {(2\pi)^{\frac n 2} \prod \sigma_i {|B|}^{\frac 1 2}} \exp\left(- \frac 1 {2|B|} \sum_i \sum_j {|B|}_{ij} (\frac {x_i - a_i} {\sigma_i})(\frac{x_j - a_j}{\sigma_j}) \right)$$

其中 
$$|B| = |b_{ij}| = \frac {E[(X(t_i)-a_i)(X(t_j)-a_j)]} {\sigma_i \sigma_j}$$

prop:
 - 广义平稳(均值与时间无关) 则 必 狭义平稳(分布与时间起点无关)
 - 若高斯过程各随机变量互不相关, 则统计独立

> 高斯随机变量的描述: $F(x) = \frac 1 {\sqrt{2\pi}} \int^{(x-a)/\sigma}_{-\inf} e^{- \frac {t^2} 2}$, 记**误差函数** $\mathrm{erf} (x) = \frac 2 {\sqrt{\pi}} \int _0 ^x e^{-x^2} \mathrm{d} x$, **补误差函数** $\mathrm{erfc} (x) =1 - \mathrm{erf}(x)$, Q函数 $Q(x) = \frac 1 2 \mathrm{erfc}(\frac x {\sqrt{2}})$, 则 $F(x) = \frac 1 2 + \frac 1 2 \mathrm{erf}(\frac{x-a}{\sqrt{2} \sigma}) = 1 - \frac 1 2 \mathrm{erfc}(\frac{x-a}{\sqrt{2} \sigma}) = 1- Q(\frac{x-a}{a})$;

### 2.4 平稳随机过程通过线性系统

def1: 线性系统 $Y(t) = X(t) \ast h(t)$ 定义见信号与系统部分

prop:
 - $E[Y(t)] = a_X \cdot \int_{\inf}^{\inf} h(t) \mathrm{d} t =  a_X \cdot H(0)$
 - $R_Y(\tau) = \iint h(\alpha)h(\beta)R_X(\tau-\beta+\alpha)\mathrm{d}\alpha\mathrm{d}\beta$
 - $P_Y(\omega) = |H(\omega)|^2\cdot P_X(\omega)$
 - 高斯过程通过线性系统仍为高斯过程

> proof on $\overline{n^2(t)}=\overline{n_c^2(t)}$: 1. $E[n_c(t)]=E[n_s(t)]$ 2. $E[n_c(t)n_s(t)]=0$ 3. $E[n^2(t)] = E[n_c^2(t)]\cos^2\omega t + E[n_s^2(t)]\sin^2\omega t + E[n_c(t)n_s(t)]\cos\omega t \sin\omega t$

### 2.6 窄带随机过程

def1: **窄带随机过程**: $X(t) = \rho(t)\cos(\omega_c t + \varphi(t)) = a_c(t)\cos\omega_c t - a_s(t) \cos\omega_s t$ 满足 $\Delta f \ll f_c$, 其中 $a_c (t) = \rho(t) \cos \varphi(t)$ 和 $a_s (t) = \rho(t) \cos \varphi(t)$ 称为**同向分量**和**正交分量**;

> 下面考虑窄带平稳高斯随机过程!

prop: 若 $X(t)$ 是窄带平稳高斯随机过程,
 - $a_c(t),\; a_s(t)$ 是平稳高斯随机过程
 - $E[a_c(t)] = E[a_s(t)] = 0$
 - $\sigma_c^2 = \sigma_s^2 = \sigma^2$
 - $R_{a_s a_c} (t) = 0 \; \forall t$

> proof: (4)$R_X(\tau)=A(t)R_{cc}+B(t)R_{sc}+C(t)R_{cs}+D(t)R_{ss}$, (3)$\sigma^2 = E[X(t)^2] = E[a_c (t)^2] \cos^2\omega_c t + E[a_s^2(t)] \cos^2\omega_c t$

prop: **窄带高斯过程**的包络特性
 - $\rho(t)$ 一维概率分布成**瑞利分布** $\frac {\rho}{\sigma^2} e^{-\rho^2 / 2 \sigma^2}$
 - $\varphi(t)$ 一维概率分布成均匀分布 $\frac 1 {2\pi}$
 - $\rho(t)$  和 $\varphi(t)$ 一维概率分布统计独立 $f(\rho,\varphi) = f(\rho)f(\varphi)$
 - ...

> proof 根据其二维概率分布
> $$f(a_c,a_s)=\frac 1 {2\pi \sigma_X^2} \exp [-\frac{a_c^2+a_s^2}{2\sigma_X^2}]$$
> $$f(\rho,\varphi)=\rho f(a_c,a_s)$$
> 解得
> $$\begin{cases}
> f_{\Rho}(\rho)= \frac{\rho}{\sigma_X^2}\exp(-\frac{\rho^2}{2\sigma_X^2})\\
> f_{\varPhi}(\varphi) = \frac 1 {2\pi}   
> \end{cases}$$
> 且 $f(\rho,\varphi) = f_{\Rho}(\rho)f_{\varPhi}(\varphi)$

### 2.7 正弦波加窄带高斯噪声

def: $r(t)=A\cos(\omega_c t+\theta) + n(t) = z(t) \cos(\omega_c t+ \varphi(t))$

同样计算可得 $f(z) = \frac z {\sigma_n^2} \exp (-\frac{z^2+A^2}{2\sigma_n^2}) \mathrm{I}_0 (\frac{Az}{\sigma_n^2})$ 其中贝塞尔第一类修正函数 $\mathrm{I}_n (x) = \frac 1 {2\pi} \int^{2\pi}_0 e^{x\cos\varphi}\mathrm{d}\varphi$
称为 **莱斯(Rice)分布**

信噪比 $\gamma = \frac{A^2}{2\sigma_n^2}$

prop: 当 $A \ll 1$, $f(z) \approx \frac z {\sigma}$; 当 $\gamma \gg 1$, $f(z) \approx \frac 1 {\sqrt{2\pi}\sigma} e^{-\frac {(z-A)^2}{2\sigma^2}}$

近似性质: $(z\ll A)\quad\frac{z}{\sigma_n^2}\exp(-\frac{z^2}{\sigma_n^2}) \quad \rightarrow \quad f(z) \quad \leftarrow\quad \frac{1}{\sqrt{2\pi\sigma_n^2}} \exp(-\frac{(z-A)^2}{2\sigma_n^2}) \quad(z\approx A)$

### 2.8 白噪声

def(白噪声): 双边频谱: $P_0(\omega) = n_0 / 2$, 单边频谱: $P_0(\omega) = n_0$

prop: $R_0 (\tau) = \frac {n_0}{2}\delta(\tau)$

def: 高斯白噪声: 同时满足白噪声频率统计特性和高斯噪声幅度统计特性

def: 低通白噪声, 带通白噪声

## 3 信道与噪声

### 3.1 信道

#### 3.1.1 信道的数学模型

- 调制信道模型: 已调信号作为输入的信道. 信道特征为有损, 通常用线性时变网络描述. 信号*乘性干扰* $k(t)$ 随时间变化称为**随参信道**, 否则为**恒参信道**.
- 编码信道模型: 包括调制解调器在内的信道, 使用转移概率矩阵描述. 见信息论

信道的实现:
- 无线信道: def: 大气层模型, 地波/天波, 微波/卫星中继, 散射通信 

### 3.2 恒参信道对信号的影响

def: **信号不失真条件**: $H(j\omega)=|H(j\omega)|e^{j\varphi(\omega)}$ 且 $|H(j\omega)|$ 不随时间变化, $\varphi(\omega) = C\omega$

def: **群时延**的度量: $\tau(\omega) = \frac{\mathrm{d} \varphi(\omega)}{\mathrm{d} \omega}$

主要的畸变影响:
- 幅度-频率畸变
- 相位-频率畸变

减小畸变的措施: 改善滤波性能(均衡), 限制已调信号频谱等

### 3.3 随参信道对信号的影响

随参信道的特点:
- 损耗随时间变化
- 时延岁时间变化
- 多径传播现象

影响:
- 多径衰落和频率弥散
- 频率选择性衰落(相关带宽 $B_c=\frac 1 {t_m}$, 其中 $t_m$ 为最大时延)

避免多径传输的方法: 工程上 $B=(\frac 1 3 ~ \frac 1 5) B_c$

随参信道特性的改善 - 分集接收: (略)

### 3.4 信道加性噪声

实际噪声的来源:
- 无线电噪声
- 内部噪声
- 工业噪声
- ...

分类:
- 单频
- 脉冲干扰
- 起伏

加性高斯白噪声(AWGN): 见信息论

## 3.5 信道容量

**香农公式**: $C = B \log_2 (1+ \frac{S}{N})$; 对AWGN, $C = B \log_2 (1+\frac{S}{n_0 B})$



## 4 模拟调制系统

### 4.1 幅度调制

- 一般双边带调幅(AM/DSB): $s_{\mathrm{AM}} (t) = (A_0 +m(t))\cos\omega_c t$
- 抑制载波的双边带调幅(DSB_SC): $s_{\mathrm{DSB}}(t) = m(t)\cos\omega_c t$ 
- 单边带调幅(SSB): $s_{\mathrm{USB}}(t) = \frac 1 2 A_m \cos(\omega_c+\omega_m)t \quad s_{\mathrm{LSB}}(t) = \frac 1 2 A_m \cos(\omega_c-\omega_m)t\quad \mathrm{以单音调制为例}$
- 残留边带调幅(VSB): $S_{\mathrm{VSB}}(\omega) = S_{\mathrm{DSB}}\cdot H_{\mathrm{VSB}}(\omega)$ 要求 $H_{\mathrm{VSB}}(\omega+\omega_c) + H_{\mathrm{VSB}} (\omega - \omega_c) = \mathrm{const}$

> for the following, DSB to be the abbr. of DSB-SC

功率分析:
- AM: $P_{\mathrm{AM}} = \frac 1 2 A_0^2 + \frac 1 2 \overline{m^2(t)}= P_c + P_s \quad (\mathrm{调制效率}\;\eta = P_s / P_{\mathrm{AM}})$
- DSB_SC: $P_{\mathrm{DSB}} = \frac 1 2 \overline{m^2(t)}$
- $P_{\mathrm{SSB}}=\frac 1 4 \overline{m^2(t)}$

恢复:
- AM: $s_{\mathrm{AM}}\cdot \cos\omega_c t \; \to \; m_o(t) = \frac 1 2 (A_0 + m(t))\quad (\mathrm{相干解调}) \; (\mathrm{包络解调下}\;m_o(t) \approx A_0 + m(t))$
- DSB_SC: (只能采用相干解调)
- SSB: $s_{\mathrm{SSB}}\cdot \cos\omega_c t \; \to \; m_o(t)=\frac 1 4 m(t)$
- VSB: $\frac 1 2 (S_{\mathrm{VSB}}(\omega - \omega_c) + S_{\mathrm{VSB}}(\omega + \omega_c)) = \frac 1 4 M(\omega)(H_{\mathrm{VSB}}(\omega - \omega_c) + H_{\mathrm{VSB}}(\omega + \omega_c)) + \textcolor{green}{\frac 1 4 (M(\omega-2\omega_c)H_{\mathrm{VSB}}(\omega-\omega_c) + M(\omega+2\omega_c)H_{\mathrm{VSB}}(\omega+\omega_c))}\quad \to \quad m_o(t)=\frac 1 4 m(t) \quad (\mathrm{由于}\omega_c \gg \omega)$

### 4.2 抗噪性能分析

> 分析信道噪声经过解调器的变化

def: 含噪调制系统模型: $m_i,n_i\quad \to \mathrm{}\quad \to \quad m_o,n_o$, 信噪比 $\frac S N = \frac{\overline{m^2(t)}}{\overline{n^2(t)}}$, 信噪比增益 $G = \frac {S_o / N_o}{S_i / N_i}$, 考虑噪声为窄带高斯白噪声 $N_i = n_0 B$

> why not $N=\frac 1 2 \overline{n^2(t)}$ : double side

**DSB分析(相干检波)**
$$\begin{cases}
    N_o = \frac 1 4 N_i = \frac 1 4 n_0 B\\
    S_i = \frac 1 2 \overline{m^2(t)}\\
    S_o = \frac 1 4 \overline{m^2(t)}\\
    S_i / N_i = \frac 1 2 \frac{\overline{m^2(t)}}{n_0 B}\\
    G = 2
\end{cases}$$

**SSB分析**
$$\begin{cases}
    S_o = \frac 1 {16} \overline{m^2(t)}\\
    N_o = \frac 1 4 N_i = \frac 1 4 n_0 B\\
    S_i = \frac 1 4 \overline{m^2(t)}\\
    G = 1\\
\end{cases}$$

**AM包络检波**
$$\begin{cases}
    S_i = \frac 1 2 A_0^2 + \frac 1 2 \overline{m^2(t)}\\
    N_i = n_0 B\\
\end{cases}$$
考虑 $s_m(t)+n_i(t) + (A_0+m(t)+n_c(t))\cos\omega_c t + n_s(t)\sin\omega_c t = A(t)\cos(\omega_c t+ \varphi(t))$. 当 $(A+m(t))\gg |n(t)|\;\forall t$ 时 $A(t)\approx A_0 + m(t) + n_c(t),\; \varphi(t)\approx 0$, 有
$$\begin{cases}
    S_o = \overline{m^2(t)}\\
    N_o = n_0 B\\
    G = \frac{2\overline{m^2(t)}}{A_0^2 + \overline{m^2(t)}}\le \frac 2 3\quad\mathrm{单音调制时可能取得最大}\\
\end{cases}$$

小信噪比输入下, 输出信噪比急剧恶化, 称为**门限效应**

## 4.3 角度调制


def: $s_m(t) = A\cos (\omega_c t+\varphi(t))$, 对相位调制 $\varphi(t) = K_P m(t)$; 对频率调制 $\varphi(t) = K_F \int^t m(t)$; 定义**调频指数** $m_f = \Delta \varphi = K_F A_m / \omega_m = \Delta \omega / \omega_m\quad (\mathrm{单音调制下})$, **频偏比** $D = \Delta f / f$; 按调频指数分类, 窄带调频NBFM $m_f \ll \frac {\pi} 6$; 反之为宽带调频WBFM;

prop:
 - 频域性质: 单音调制下 $s_{\mathrm{FM}} (t) = A\sum_{-\inf}^{+\inf} J_n(m_f) \cos (\omega_c + n\omega_m)$; 故规定带宽 $B_{\mathrm{FM}}=2(m_f+1)f_m$; 一般调制下 $=2(D+1)f_m$
 - 窄带近似 $s_{\mathrm{NBFM}} (t) \approx \cos \omega_c t + \frac {A_mK_F}{2\omega_m} (\cos(\omega_c+\omega_m)t - \cos(\omega_c-\omega_m)t)$; 带宽 $B\approx 2\Delta f$
 - 功率 $P_{\mathrm{FM}} = \overline{s^2(t)} = \frac {A^2} 2$

调频信号的调制解调过程
 - 产生
   - 直接法: 压控振荡器VCO
   - 间接法: 通过倍频, 滤波方法将NBFM转换为WBFM
 - 解调
   - 非相干法: 微分/积分+包络检波
   - 相干法: 将NBFM近似为AM, 相干载波 $c(t)=-\sin\omega_c t$

## 4.4 调频系统抗噪声性能

大信噪比下
$$3m_i^2(m_i+1)$$

# 5 数字基带传输系统

def: 不使用调制方式直接传输基带信号的方法

## 5.1 数字基带信号

### 5.1.1 数字基带信号码型

def: (单极性/双极性)-(归零/非归零)码: 
 - 单极性: 0, 1 对应零电平, 正电平
 - 双极性: 0, 1 对应负电平, 正电平
 - 归零: 在一个码元宽度 $T_b$ 中出现零电平一次
 - 对归零信号, 定义**占空比** $\tau/T_b$, 其中 $\tau$ 是脉冲宽度

def 差分码: 1码表示电平跳变;

def AMI码: 1ma序列是交替的正, 负电平

def HDB3码: 在AMI码的基础上, 对连续4个0码: 对第4个0码使用V(!=0)码表示, V码序列正负交替; 若V码与上一个1码极性不同, 则对第1个0码使用B(=V)码

def 双相码: 对连续脉冲做相位编码, 1码为正-负脉冲

def 密勒码: 相当于差分码在码元中间跳变

def CMI传号反转码: 1码交替11, 00, 0码01

### 5.1.2 基带信号频谱统计特性

def 数字基带信号的数学表示 $s(t)=\sum s_n(t) = \sum x(n)\;?\;g_1(t-nT_b)\;:\;g_2(t-nT_b)$, 其统计特性为 $v(t)=\sum (P g_1(t-nT_b) + (1-P)g_2(t-nT_b))$, 称为**稳态波**, 其中 $P$ 为出现0码的概率; **交变波**为 $u(t)=s(t)-v(t)$

prop 数字基带信号的**功率谱密度**: 
$$\begin{cases}
    P_v(f) &= \sum_{m=-\inf}^{+\inf} |f_b (PG_1 (m f_b) + (1-P) G_2 (m f_b))|^2 \delta (f - m f_b)\\
    P_u(f) &= f_b P (1-P) |G_1(f) - G_2(f)|^2\\
\end{cases}$$

## 5.2 基带传输系统的工作原理

脉冲形成器 - 发送滤波器 - 信道 - 接收滤波器/同步电路 - 抽样判决器 - 码元再生器(?)

由于滤波器+信道传输特性不理想, 特征脉冲响应拖尾,造成判决困难, 称为**码间串扰**

## 5.3 无码间串扰的条件

- 时域条件: $h(kT_b) = 0\quad (k\ne 0)$ (注: 只考虑采样点无串扰)
- 频域条件: $\sum_i H(\omega + \frac{2\pi i}{T_b}) = T_b \quad (|\omega|\le \frac{\pi}{T_b})$

理想低通滤波器是理想的基带传输系统, 但是不可实现且冲激响应拖尾大; 实践上设计有**滚降**特性的 $H(\omega)$, 用频带利用率换取更小拖尾;

def: 频带利用率 $\eta = \frac {R_B}{B} = \frac {2}{1+\alpha}$, 其中 $f_N$ 是奈奎斯特带宽, $\alpha = \frac{\Delta f}{f_N}$ 是滚降系数, $R_B = 2 f_N$ 是最大码元传输速率;


## 5.4 无码间串扰下的抗噪声性能

考察双极性非归零信号, $g_1 = -A+n$, $g_2 = A+n$, 其中 $n$ 为高斯噪声, 方差 $\sigma_n$, 此时总误码率为 $R_e = (1-P)\int^{V}_{-\inf} f_1(x)\mathrm{d} x + P\int^{+\inf}_{V} f_2(x)\mathrm{d} x$ (其中 $f_1,\; f_2$ 是0, 1码的概率分布), 当 $V=\frac{\sigma_n^2}{2A} \ln (\frac{P}{1-P})$ 时取得极值; 当 $P=\frac 1 2$ 时, 误码率 $P_e = \frac 1 2 \mathrm{efrc} (\frac{A}{2\sqrt{2} \sigma_n})$

## 5.5 部分响应系统(本章以下略)

考虑码元波形 
$$g(t) = \mathrm{Sa}(\frac{\pi}{T_b}(t+\frac{T_b}{2})) + \mathrm{Sa}(\frac{\pi}{T_b}(t-\frac{T_b}{2})) = \frac 4 {\pi} \frac{\cos(\pi t / T_b)}{1 - (2t/T_b)^2}$$
时域占用 $3T_b$, 频谱 $G(\omega) = 2 T_b \cos \frac{\omega T_b}{2} \quad (|\omega| \le \frac{\pi}{T_b})$ 发现拖尾更小, 频带利用率更高; $g(t)$ 为一种**部分响应波形**

部分响应系统不能直接采样判决; 如采样值 $c_k = a_k + a_{k-1}$, 则判决 $a_k = c_k - a_{k-1}$;

部分响应系统的一般形式为 $c_k = R_i b_k + R_2 b_{k-1} + ...$

## 5.6 眼图
可以反映最佳抽样时刻, 噪声容限, 对定时误差的灵敏度等;

## 5.7 时域均衡原理

概念: 插入可调滤波器, 减小码间串扰; 实现: 有限长横向滤波器 $y(t)=\sum_{-N}^{N} C_i x(t-i T_b)$, 其中 $y(t)$ 用于判决; 均衡效果的标准包括: 峰值畸变 $D=\frac 1 {y_0} \sum_{k\ne 0} |y_k|$ 和均方畸变 $e^2 = \frac 1 {y_0^2} \sum_{k\ne 0} y_k^2$

自适应均衡器的设计:...

# 6 数字信号的频带传输

- 二进制幅度键控2ASK $s(t)=\sum a_n G_1(t-n T_b),\; s_{\mathrm{2ASK}} (t) = s(t) \cos\omega_c t$ 功率谱 $P_s (f) = \frac 1 4 T_b \mathrm{Sa}^2(\pi f T_b) + \frac 1 4 \delta(f),\; P_e (f) = \frac 1 4 (P_s (f+f_c) + P_s (f - f_c))$, 带宽 $B_{\mathrm{2ASK}} = 2 R_B$, 相干解调下误码率($P=\frac 1 2$) $P_e = \frac 1 2 \mathrm{erfc} \frac 1 2 \sqrt{r} \approx \frac 1 {\sqrt{\pi r}} e^{-\frac r 4}$ 其中信噪比 $r=\frac{a^2}{2\sigma_n^2}$ ; 包络检波时抽样值满足莱斯分布/瑞利分布, 大信噪比 $r \gg 1$ 下误码率 $P_e =\approx \frac 1 2 (\frac 1 {\sqrt{\pi r}} + 1) e^{-\frac r 4} \approx \frac 1 2 e{-\frac r 4}$
- 二进制频移键控2FSK $s_{\mathrm{2FSK}}(t) = s(t)\cos(\omega_1 t + \varphi) + (1-s(t)) \cos(\omega_2 + \theta)$, 解调方法包括包络检波法(对 $\omega_1,\omega_2$ 滤波), 相干检测法, 过零检测法和差分检测法; 带宽 $B_{\mathrm{2FSK}} = (2+D) f_b$ 其中$D = |f_2-f_1| / f_b$ 为频偏率; 误码率: 相干检测下 $P_e = \frac 1 2 \mathrm{erfc} (\sqrt {\frac r 2}) \approx \frac 1 {\sqrt{2\pi r}} e^{-\frac r 2}$; 包络检波下 $P_e = \frac 1 2 E^{-\frac r 2}$; 包络检波下无需设置门限;
- 二进制相移键控2PSK: 带宽 $2f_b$, 相干检波下误码率 $\frac 1 2 \mathrm{erfc} (\sqrt r) \approx \frac 1 {2 \sqrt{\pi r}} e^{-r}$; 不存在包络检波;
- 二进制差分相移键控: $P'_e = 2(1-P_e)P_e \approx 2 P_e$; 可使用差分解调(延迟 $T_b$ 并相乘), $P_e = \frac 1 2 e^{-r}$

总结如下:

| entry        | 2FSK                                       | 2ASK                                       |
| ------------ | ------------------------------------------ | ------------------------------------------ |
| coherent     | $\frac 1 2 \mathrm{erfc} \sqrt{\frac r 2}$ | $\frac 1 2 \mathrm{erfc} \sqrt{\frac r 4}$ |
| non-coherent | $\frac 1 2 e^{-\frac r 2}$                 | $\frac 1 2 e^{-\frac r 4}$                 |
| B            | $\mathrm{abs}(f_1 - f_2) + \frac 2 {T_b}$  | $\frac 2 {T_b}$                            |

| entry        | 2DPSK                  | 2PSK                              |
| ------------ | ---------------------- | --------------------------------- |
| coherent     | $\mathrm{erfc}\sqrt r$ | $\frac 1 2 \mathrm{erfc} \sqrt r$ |
| non-coherent | $\frac 1 s e^{-r}$     | N.A.                              |
| B            | $\frac 1 {2T_b}$       | $\frac 1 {2T_b}$                  |
| judge cond   |                        |                                   |

> FSK占用带宽过大, 应设计 $f_1,f_2$ 得到 MSK(minimal shift key)

## 6.6 多进制数字调制系统

### 幅度键控MASK

带宽 $B_{\mathrm{MASK}} = 2 R_B$, 码元频带利用率 $\eta = \frac 1 2 \; \mathrm{Baud/Hz}$, 信息频带利用率 $\eta_b = \frac{\log M}{2} \; \mathrm{bit}$, 误码率 $P_e = \frac{M-1}{M} \mathrm{erfc} \sqrt{\frac{3r}{M^2 -1}}$;

### 频移键控MFSK

带宽 $B_{\mathrm{MFSK}} = 2MR_B$, 误码率 $\frac{M-1}{2}\mathrm{erfc} \sqrt{\frac r 2} \quad or \quad \frac{M-1}{2} e^{- \frac r 2}$;

### 相移键控MPSK

相位的配置方式: A方式(从零相位开始), B方式; 二相制, 四相制, 八相制;

频谱利用率 $B_{\mathrm{MPSK}} = 2R_B$, 产生方法有直接调相法和相位选择法;


# 8 模拟信号的数字传输

## 抽样定理 

常用的抽样方法:
- 理想抽样 $\cdot \delta_T (t) = \sum \delta (t-kT)$
- 自然抽样 $\cdot s(t) = \frac{A\tau}{T_s} \sum \mathrm{Sa} (\frac{k\omega_s \tau}{2}) e^{jk\omega t}$, $\ast S(\omega) = \frac{2\pi A\tau}{T_s} \sum \mathrm{Sa} (\frac{k\omega_s \tau}{2}) \delta(\omega - k \omega_s)$
- 平顶抽样 $\cdot \delta_T$,$\ast q(t) = AG_{\tau} (t)$, $\cdot Q(\omega) = A\tau \mathrm{Sa} (\frac{\omega \tau}{2})$
- 脉冲调制: 极少使用, 略

## 模拟信号的量化

均匀量化: 若量化值在 $(-a,a)$ 间均匀分布, 量化级 $M$, 则量化信噪比 $\frac{S_0}{N_q} = M^2$

非均匀量化: A率压缩和 $\mu$ 率压缩
$$
    A:\quad y=\begin{cases}
        \frac{Ax}{1+\ln A}\\
        \frac{1+Ax}{1+\ln A}\\
    \end{cases} $$
$$
    B:\quad  y = \frac{\ln(1+\mu x)}{\ln(1+\mu)}\\
$$

13折线法

## 脉冲编码调制PCM

组成: 极性码, 段落码 $\overline{a_1 a_2 a_3}$, 段内码 $\overline{b_1...b_4}$, 起始电平 $\Delta_0 = 0:8\cdot 2^{\overline{a_1 a_2 a_3}}$, 量化间隔 $0:(2^{\overline{b_1...b_4} - 1})$

> 噪声分析考虑自然码, 均匀分布

PCM噪声来源于量化噪声和信道加性噪声 $f_0(t) + n_q (t) + n_e (t)$, 量化噪声功率比 $\frac{S_0}{N_q} = M^2$, 加性噪声信噪比 $\frac{S_0}{N_0} = \frac 1 {4 P_e}$

## 增量调制

## 时分复用TDM


# 9 差错控制编码

## 9.1 差错控制编码的原理

def: 信源编码: 提高有效性(e.g. 无损压缩, 量化编码); 信道编码: 提高可靠性(差错控制编码等)

错误的类型: 随机性错误(白噪声, 单个); 突发性错误(脉冲干扰, 连续多个)

**差错控制技术**包括反馈检验; 前向纠错; 检错重发等;;**差错控制编码**包括检错码和纠错码; 

def: 线性码(码字空间构成线性子空间); 分组码(监督码元仅监督同一码组中的信息); 系统码(信息位和监督位有确定的位置关系)

## 9.2 常用检错码

奇偶校验码; 水平垂直奇偶校验(对 $k^2$ 个信息码阵添加 $2k+1$ 个奇偶校验); 群计数码; 等重码(恒比码); 正反码;

## 9.3 线性分组码

将一个码组视作行向量 $A \in (Z/2Z)^n$, 由 $A^T = G^T \cdot X^T, \quad (X \in (Z/2Z)^k)$ 生成, 其中 $G \in (Z/2Z)^{k \times n}$ 称为**生成矩阵**, 有效码组张成空间 $\ker H$, 并有监督方程 $H\cdot A^T = 0$, 其中 $H \in (Z/2Z)^{r \times n}$
称为**监督矩阵**;

考察 $A$ 出现错误 $A'=A+E$, $E$ 称为**错误图样**, 计算 $S=H\cdot A'^T = H\cdot E^T$ 称为**校正子**, 其只与 $E$ 有关而与 $A$ 无关;

若 $H,G$ 满足形式 $H=(P\; I_r),\; G = (I_k \; Q)$, 则称为对应的**典型阵**, 此时的码组前k位不变, 后r位为监督码, $G$ 每列生成一位监督码, $H$ 每行验证一位监督码; 典型阵对应系统码; 

由于 $\forall \; X\; H\cdot A^T = H\cdot G^T \cdot X^T = 0$, 得 $H\cdot G^T = 0$; 对于典型生成阵和典型监督阵, 满足 $P+Q^T = 0 \quad (\leftrightarrow P=Q^T)$;

### 9.4 循环码

循环码是一种线性分组码, 其性质为有效码组的循环移位仍为有效码组;

> 将码组视作最高位不大于 $n-1$ 的多项式 $(a_0,...) \; \to \; A(x)\sum_{i=0}^{n-1}a_i x^i \in (\mathbb{F}_2 [X])/(I(x))$,
> 其中 $I(x)$ 限制最高位, 通常取 $I(x)=x^n+1$;
> 生成 $A(x) = g(x) X(x)$, 监督 $h(x) A(x) = 0 (\exist h(x)) \; \mathrm{or} \; A(x)=0 \; \mathrm{mod}\; g(x)$, 
> 显然有结论 $h(x)g(x)=0$; $\{A(x)\}$ 是由 $g(x)$ 生成的理想, 对乘法封闭, 因而有循环性质;
>
> 在 $\mathbb{F}_2^{1\times n}$ 上构造乘法 $a\cdot b = c \quad (c_i = a_i B_{ij})$;
> 在 $(\mathbb{F}_2 [X])/(I(x))$ 上的乘法 $a(x) \cdot b(x) = (\sum a_ix^i)(\sum b_j x^j)$;
> 若 $I(x)=x^n + 1$ 则乘法简化为 $a(x) \cdot b(x) = \sum a_i \sum b_j x^{\overline{i+j}} = \sum a_i \sum b_{\overline{j - i}} x^j$, 其中 $\overline{x} = x \; \mathrm{mod} \; n$; 
> 进一步构造乘法的关系 $B_{ij} = b_{\overline{j-i}}$ 得到同构 $\mathbb{F}_2^{1\times n} \cong (\mathbb{F}_2 [X]) / (I(x)), \; a=(a_0,...) \to a(x)=\sum a_i x^i$, $G,H$ 可以通过 $g(x),h(x)$ 得到, 从而循环码属于线性分组码;

循环码求 $G,H$:
- 确定n,k
- 得到 $I(x)=x^n+1$, 构造 $g(x) = x^{n-k}+...+1$, $G \leftarrow \binom{x^0 g(x)}{...}$
- 对 $G$ 典型化并利用典型阵性质 $P=Q^T$ 求 $H$

**循环码编码**: $r(x) = x^{n-k}m(x) \;\mathrm{mod}\; g(x)$, 输出 $A(x) = x^{n-k}m(x) + r(x)$ (或称 $T(x)$), 可以构造除法电路(?)

循环码译码: 略

## 9.5 卷积码

略


# 10 数字信号的最佳接收

## 10.2 通信系统统计判决模型

信号空间S, 噪声空间n, 观察空间X, 判决空间Y

## 10.3 根据最小错误准则设计相关接收机

根据平均误码率 $P_e = P(s_1) \int^{x} p(x'|s_1) \mathrm{d} x' + P(s_2) \int_{x} p(x'|s_2) \mathrm{d} x'$ 是下凸函数, 在 $\partial P_e / \partial x = 0$ 时取得最小值, 因此得到判决标准 $\frac{p(x|s_1)}{p(x|s_2)} \quad ?\quad \frac{P(s_1)}{P(s_2)}$

> 推广到多进制为 $\argmax p(x|s_i)/P(s_i)$;

考虑AWGN作用, $p(x|s_i) \sim \exp (-\frac 1 {n_0} \int^T_0 (x(t)-s(t))^2\mathrm{d} t)$, $i=1,2$, 得到相关性判决条件 $\int^T_0 x(t) s_1 (t) \mathrm{d} t -\int^T_0 x(t) s_2 (t) \mathrm{d} t \quad ?\quad \frac {n_0} 2 \ln \frac {p_2}{p_1} + \frac 1 2 \int^t_0 (s_1(t) - s_2 (t))^2 \mathrm{d} t \quad (1:2)$ 从而构成相关检测式的最佳接收机

> 书中将在T时间内的k点采样近似为连续过程, 带来常数项 $\frac 1 {(\sqrt{2\pi} \sigma_n)^2}$, 这是由于AWGN与 $\tau$ 无关, 快速随机变化带来收敛? 将噪声视为AWGN是不严谨的?

### 10.4 根据最大信噪比准则设计匹配滤波器

单个信号 $s$ 通过线性滤波器, 在 $t_0$ 时刻都信噪比 

$$r(t) = \frac{|\frac 1 {2\pi} \int H(\omega) S(\omega) e^{j\omega t_0}\mathrm{d} \omega|^2}{\frac {n_0}{4\pi} \int |H(\omega)|^2 \mathrm{d} \omega} \le \frac{\frac 1 {4\pi^2} \int |H(\omega)|^2 \mathrm{d} \omega \int |S(\omega)|^2 \mathrm{d} \omega}{\frac {n_0}{4\pi} \int |H(\omega)|^2 \mathrm{d} \omega} = \frac {2E}{n_0}$$ 

当 $H(\omega) = K S^8 (\omega) e^{-j\omega t_0}$ 时取等, 由此设计匹配滤波器

匹配滤波器单位冲击响应 $h(t) = K s(t-t_0)$, 对期望的信号, 匹配滤波器输出是自相关函数的时移

### 10.5 二进制最佳接收机抗噪性能

根据相关接收机的判决公式, 
$$P_e = P(s_1) \frac 1 {\sqrt{2\pi} \sigma_{\epsilon}} \int^a e^{-\frac {x^2}{2\sigma_{\epsilon}^2}}\mathrm{d} x + P(s_2) \frac 1 {\sqrt{2\pi} \sigma_{\epsilon}} \int^{-a} e^{-\frac {x^2}{2\sigma_{\epsilon}^2}}$$
其中 $a$ 为判 $s_1$ 门限, $\epsilon = \int^T_0 n(t) (s_1(t) - s_2(t)) \mathrm{d} t$ 为噪声对相关函数计算的作用

在等概下 $P_e = \frac 1 2 \mathrm{erfc} \sqrt{\frac{E_b (1-\rho)}{2n_0}}$, 其中 $E_b=\frac 1 2 \int^T_0 s_1^2(t) + s_2^2 (t) \mathrm{d} t$ 是码元平均能量, $\rho$ 是 $s_1, s_2$ 的相关系数

#### 最佳接收机和普通接收机比较

最佳接收机 $\frac {E_b}{n_0} = \frac{S T_b}{n_0}$, 普通接收机 $r = \frac{S}{n_0 B}$, 普通接收机要求 $B \ge \frac 2 {T_b}$

#### 正交接收机实现随相信号最佳接收

显然