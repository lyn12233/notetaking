# 通信原理

## 1 绪论

### 1.1 通信系统的组成

- 模拟通信系统的组成: 信源, 调制器, 信道, 解调器, 信宿
- 数字通信系统的组成: 信源, 加密器, 编码器, 调制器, 信道, 解调器, 译码器, 解密器, 信宿

> 将没有调制解调的数字通信系统称为**基带传输通信系统**
>
> 进行模数转换称为模拟信道的数字化

### 1.2 数字通信的主要特点

抗干扰能力强, 差错可控, 易加密, 与现代技术结合; 频带利用率不高, 设备复杂

### 1.3 通信系统的分类

- 按传输介质:
- 按信号特征: 数字, 模拟
- 按工作频段: <>
- 按调制方式: 基带, 频带
- 移动通信, 固定通信
- 频分复用, 时分复用, 码分复用, 空分复用

### 1.4 通信方式的分类

- 单工, 全双工, 半双工
- 串序, 并序

### 1.5 通信系统的性能指标

- 有效性: (速度)
- 可靠性: (质量)
- 适应性, 经济性, 保密性等

> 对信息量和信息熵, 见信息论部分

- 有效性指标: 码元传输速率: $R_B = \frac 1 {T_B} \quad (\mathrm{Baud})$ 信息传输速率: $R_b = R_B\cdot \log_2 M \quad (\mathrm{bits}/s)$, 频带利用率: $\eta = \frac {R_B} B \quad \eta_b = \frac {R_b} B$
- 可靠性指标: 码元差错率: $P_e = \mathrm{false\; codes} /\mathrm{revceoved\;codes}$, 信息差错率: $\mathrm{false\;bits}/\mathrm{received\;bits}$

## 2 随机信号和噪声分析

### 2.1 定义

def1: 随机过程 $X(t)$ 表示在时刻 $t_1$ 为随机变量 $X(t_1)$, 分布函数为: $F_1(x_1,_1)=P[X(t_1)\le x_1]$, 密度函数为: $f_1 (x_1,t_1) = \frac {\partial F_1 (x,t_1)}{\partial x}|_x\quad (\mathrm{if\;exists})$, 随机过程的二维概率分布函数为 $F_2(x_1,x_2,t_1,t_2) = p[X(t_1)\le x_1 \;\And\; X(t_2)\le x_2]$

def2: 随机过程的数学期望: $a(t) = E[X(t)]$, 方差: $\sigma^2 (t) = D[X_(t)]$, 相关函数: $R_{XY} (t_1,t_2) = E[X(t_1)Y(t_2)]\quad (X=Y\;\mathrm{称为自相关})$, 协方差 $B(t_1,t_2) = E[(X(t_1)-a(t_1))(X(t_2)-a(t_2))]$

### 2.2 平稳随机过程

def1: 平稳随机过程: 二维分布函数只与 $\tau=t_2-t_1$ 有关

prop: 期望 $a(t) =a$ 与 $t$ 无关, 自相关函数 $R(t_1,t_2) = R(\tau)$ 只与 $\tau$ 有关

def2: 平稳随机过程的各态历经性: $a=\overline{a} ,\; R(\tau) = \overline R (\tau)\quad \mathrm{对每一次实现平均}$

#### 2.2.2 平稳随机过程的自相关函数

prop: 
 - 是偶函数
 - $R(0)$ 是 $R(\tau)$ 的上界
 - 平均功率, 直流功率, 交流功率: $R(0)=E[X(t)^2],\;R(\inf)=E^2[X(t)]=a^2,\;\sigma^2 = R(0)-R(\inf)$

#### 2.2.3 平稳随机过程的功率谱密度

def: (根据维纳-定理) 
$$\begin{cases}
    P_X(\omega) &=& \int^{\inf}_{-\inf} R(\tau) e^{-i\omega \tau}\mathrm{d} \tau\\
    R(\tau) &=& \frac 1 {2\pi} \int^{\inf}_{-\inf} P_X (\omega) e^{i\omega t}\mathrm{d} \omega
\end{cases}$$

prop $P_X(\omega)$ 的性质:
 - 是确定函数
 - 是偶函数
 - 非负性
 - 是任意实现的功率谱密度

### 2.3 高斯随机过程

def1: 高斯过程: 
$$f(x_1,...,x_n,t_1,...,t_n) = \frac 1 {(2\pi)^{\frac n 2} \prod \sigma_i {|B|}^{\frac 1 2}} \exp\left(- \frac 1 {2|B|} \sum_i \sum_j {|B|}_{ij} (\frac {x_i - a_i} {\sigma_i})(\frac{x_j - a_j}{\sigma_j}) \right)$$

其中 
$$|B| = |b_{ij}| = \frac {E[(X(t_i)-a_i)(X(t_j)-a_j)]} {\sigma_i \sigma_j}$$

prop:
 - 广义平稳(均值与时间无关) 则 必 狭义平稳(分布与时间起点无关)
 - 若高斯过程各随机变量互不相关, 则统计独立

> 高斯随机变量的描述: $F(x) = \frac 1 {\sqrt{2\pi}} \int^{(x-a)/\sigma}_{-\inf} e^{- \frac {t^2} 2}$, 记误差函数 $\mathrm{erf} (x) = \frac 2 {\sqrt{\pi}} \int _0 ^x e^{-x^2} \mathrm{d} x$, 补误差函数 $\mathrm{erfc} (x) =1 - \mathrm{erf}(x)$, Q函数 $Q(x) = \frac 1 2 \mathrm{erfc}(\frac x {\sqrt{2}})$, 则 $F(x) = \frac 1 2 + \frac 1 2 \mathrm{erf}(\frac{x-a}{\sqrt{2} \sigma}) = 1 - \frac 1 2 \mathrm{erfc}(\frac{x-a}{\sqrt{2} \sigma}) = 1- Q(\frac{x-a}{a})$;

### 2.4 平稳随机过程通过线性系统

def1: 线性系统 $Y(t) = X(t) \ast h(t)$ 定义见信号与系统部分

prop:
 - $E[Y(t)] = a_X \cdot \int_{\inf}^{\inf} h(t) \mathrm{d} t =  a_X \cdot H(0)$
 - $R_Y(\tau) = \iint h(\alpha)h(\beta)R_X(\tau-\beta+\alpha)\mathrm{d}\alpha\mathrm{d}\beta$
 - $P_Y(\omega) = |H(\omega)|^2\cdot P_X(\omega)$
 - 高斯过程通过线性系统仍为高斯过程

> proof on $\overline{n^2(t)}=\overline{n_c^2(t)}$: 1. $E[n_c(t)]=E[n_s(t)]$ 2. $E[n_c(t)n_s(t)]=0$ 3. $E[n^2(t)] = E[n_c^2(t)]\cos^2\omega t + E[n_s^2(t)]\sin^2\omega t + E[n_c(t)n_s(t)]\cos\omega t \sin\omega t$

### 2.6 窄带随机过程

def1: $X(t) = \rho(t)\cos(\omega_c t + \varphi(t)) = a_c(t)\cos\omega_c t - a_s(t) \cos\omega_s t$ 满足 $\Delta f \ll f_c$

prop: 若 $X(t)$ 是窄带平稳高斯随机过程,
 - $a_c(t),\; a_s(t)$ 是平稳高斯随机过程
 - $E[a_c(t)] = E[a_s(t)] = 0$
 - $\sigma_c^2 = \sigma_s^2 = \sigma^2$
 - $R_{a_s a_c} (t) = 0 \; \forall t$

prop: **窄带高斯过程**的包络特性
 - $\rho(t)$ 一维概率分布成瑞利分布
 - $\varphi(t)$ 一维概率分布成均匀分布
 - $\rho(t)$  和 $\varphi(t)$ 一维概率分布统计独立
 - ...

> proof 根据其二维概率分布
> $$f(a_c,a_s)=\frac 1 {2\pi \sigma_X^2} \exp [-\frac{a_c^2+a_s^2}{2\sigma_X^2}]$$
> $$f(\rho,\varphi)=\rho f(a_c,a_s)$$
> 解得
> $$\begin{cases}
> f_{\Rho}(\rho)= \frac{\rho}{\sigma_X^2}\exp(-\frac{\rho^2}{2\sigma_X^2})\\
> f_{\Varphi}(\varphi) = \frac 1 {2\pi}   
> \end{cases}$$
> 且 $f(\rho,\varphi) = f_{\Rho}(\rho)f_{\Varphi}(\varphi)$

### 2.7 正弦波加窄带高斯噪声

def: $r(t)=A\cos(\omega_c t+\theta) + n(t) = z(t) \cos(\omega_c t+ \varphi(t))$

同样计算可得 $f(z) = \frac z {\sigma_n^2} \exp (-\frac{z^2+A^2}{2\sigma_n^2}) \mathrm{I}_0 (\frac{Az}{\sigma_n^2})$ 其中贝塞尔第一类修正函数 $\mathrm{I}_n (x) = \frac 1 {2\pi} \int^{2\pi}_0 e^{x\cos\varphi}\mathrm{d}\varphi$
称为 $\mathrm{Rice}$ 分布

信噪比 $\gamma = \frac{A^2}{2\sigma_n^2}$

近似性质: $(z\ll A)\quad\frac{z}{\sigma_n^2}\exp(-\frac{z^2}{\sigma_n^2}) \quad \rightarrow \quad f(z) \quad \leftarrow\quad \frac{1}{\sqrt{2\pi\sigma_n^2}} \exp(-\frac{(z-A)^2}{2\sigma_n^2}) \quad(z\approx A)$

### 2.8 白噪声

def(白噪声): 双边频谱: $P_0(\omega) = n_0 / 2$, 单边频谱: $P_0(\omega) = n_0$

prop: $R_0 (\tau) = \frac {n_0}{2}\delta(\tau)$

def: 高斯白噪声: 同时满足白噪声频率统计特性和高斯噪声幅度统计特性

def: 低通白噪声, 带通白噪声

## 3 信道与噪声

### 3.1 信道

#### 3.1.1 信道的数学模型

- 调制信道模型: 已调信号作为输入的信道. 信道特征为有损, 通常用线性时变网络描述. 信号*乘性干扰* $k(t)$ 随时间变化称为**随参信道**, 否则为**恒参信道**.
- 编码信道模型: 包括调制解调器在内的信道, 使用转移概率矩阵描述. 见信息论

### 3.2 恒参信道对信号的影响

def: **信号不失真条件**: $H(j\omega)=|H(j\omega)|e^{j\varphi(\omega)}$ 且 $|H(j\omega)|$ 不随时间变化, $\varphi(\omega) = C\omega$

def: 群时延特性度量: $\tau(\omega) = \frac{\mathrm{d} \varphi(\omega)}{\mathrm{d} \omega}$

主要的畸变影响:
- 幅度-频率畸变
- 相位-频率畸变

减小畸变的措施: 改善滤波性能(均衡), 限制已调信号频谱等

### 3.3 随参信道对信号的影响

- 多径衰落和频率弥散
- 频率选择性衰落(相关带宽 $B_c=\frac 1 {t_m}$, 其中 $t_m$ 为最大时延)

随参信道特性的改善 - 分集接收:

加性高斯白噪声(AWGN): 见信息论

香农公式: $C = B \log_2 (1+frac{S}{N})$; 对AWGN, $C = B \log_2 (1+frac{S}{n_0 B})$

## 4 模拟调制系统

### 4.1 幅度调制

- 一般双边带调幅(AM/DSB): $s_{\mathrm{AM}} (t) = (A_0 +m(t))\cos\omega_c t$
- 抑制载波的双边带调幅(DSB_SC): $s_{\mathrm{DSB}}(t) = m(t)\cos\omega_c t$ 
- 单边带调幅(SSB): $s_{\mathrm{USB}}(t) = \frac 1 2 A_m \cos(\omega_c+\omega_m)t \quad s_{\mathrm{LSB}}(t) = \frac 1 2 A_m \cos(\omega_c-\omega_m)t\quad \mathrm{以单音调制为例}$
- 残留边带调幅(VSB): $S_{\mathrm{VSB}}(\omega) = S_{\mathrm{DSB}}\cdot H_{\mathrm{VSB}}(\omega)$ 要求 $H_{\mathrm{VSB}}(\omega+\omega_c) + H_{\mathrm{VSB}} (\omega - \omega_c) = \mathrm{const}$

> for the following, DSB to be the abbr. of DSB-SC

功率分析:
- AM: $P_{\mathrm{AM}} = \frac 1 2 A_0^2 + \frac 1 2 \overline{m^2(t)}= P_c + P_s \quad (\mathrm{调制效率}\;\eta = P_s / P_{\mathrm{AM}})$
- DSB_SC: $P_{\mathrm{DSB}} = \frac 1 2 \overline{m^2(t)}$
- $P_{\mathrm{SSB}}=\frac 1 4 \overline{m^2(t)}$

恢复:
- AM: $s_{\mathrm{AM}}\cdot \cos\omega_c t \; \to \; m_o(t) = \frac 1 2 (A_0 + m(t))\quad (\mathrm{相干解调}) \; (\mathrm{包络解调下}\;m_o(t) \approx A_0 + m(t))$
- DSB_SC: (只能采用相干解调)
- SSB: $s_{\mathrm{SSB}}\cdot \cos\omega_c t \; \to \; m_o(t)=\frac 1 4 m(t)$
- VSB: $\frac 1 2 (S_{\mathrm{VSB}}(\omega - \omega_c) + S_{\mathrm{VSB}}(\omega + \omega_c)) = \frac 1 4 M(\omega)(H_{\mathrm{VSB}}(\omega - \omega_c) + H_{\mathrm{VSB}}(\omega + \omega_c)) + \textcolor{green}{\frac 1 4 (M(\omega-2\omega_c)H_{\mathrm{VSB}}(\omega-\omega_c) + M(\omega+2\omega_c)H_{\mathrm{VSB}}(\omega+\omega_c))}\quad \to \quad m_o(t)=\frac 1 4 m(t) \quad (\mathrm{由于}\omega_c \gg \omega)$

### 4.2 抗噪性能分析

> 分析信道噪声经过解调器的变化

def: 含噪调制系统模型: $m_i,n_i\quad \to \mathrm{}\quad \to \quad m_o,n_o$, 信噪比 $\frac S N = \frac{\overline{m^2(t)}}{\overline{n^2(t)}}$, 信噪比增益 $G = \frac {S_o / N_o}{S_i / N_i}$, 考虑噪声为窄带高斯白噪声 $N_i = n_0 B$

> why not $N=\frac 1 2 \overline{n^2(t)}$ : double side

**DSB分析(相干检波)**
$$\begin{cases}
    N_o = \frac 1 4 N_i = \frac 1 4 n_0 B\\
    S_i = \frac 1 2 \overline{m^2(t)}\\
    S_o = \frac 1 4 \overline{m^2(t)}\\
    S_i / N_i = \frac 1 2 \frac{\overline{m^2(t)}}{n_0 B}\\
    G = 2
\end{cases}$$

**SSB分析**
$$\begin{cases}
    S_o = \frac 1 {16} \overline{m^2(t)}\\
    N_o = \frac 1 4 N_i = \frac 1 4 n_0 B\\
    S_i = \frac 1 4 \overline{m^2(t)}\\
    G = 1\\
\end{cases}$$

**AM包络检波**
$$\begin{cases}
    S_i = \frac 1 2 A_0^2 + \frac 1 2 \overline{m^2(t)}\\
    N_i = n_0 B\\
\end{cases}$$
考虑 $s_m(t)+n_i(t) + (A_0+m(t)+n_c(t))\cos\omega_c t + n_s(t)\sin\omega_c t = A(t)\cos(\omega_c t+ \varphi(t))$. 当 $(A+m(t))\gg |n(t)|\;\forall t$ 时 $A(t)\approx A_0 + m(t) + n_c(t),\; \varphi(t)\approx 0$, 有
$$\begin{cases}
    S_o = \overline{m^2(t)}\\
    N_o = n_0 B\\
    G = \frac{2\overline{m^2(t)}}{A_0^2 + \overline{m^2(t)}}\le \frac 2 3\quad\mathrm{单音调制时可能取得最大}\\
\end{cases}$$

小信噪比输入下, 输出信噪比急剧恶化, 称为门限效应

## 4.3 角度调制